{% extends "common/mobile-index.phtml" %}
{% block title  %}兼职之家 - 发布岗位{% endblock %}

{% block content %}
<style type="text/css">
	body,html {
		background: #fff;
	}
	.statbox img.auto-center {
		max-width: 90%;
	}
	.resu {
		padding:0;
	}
	
	.imgbox {
	    margin: 0 auto;
	    margin-top: 10px;
	}
	.col-xs-6 button {
		display: block;
		width: 100%;
	    height: 3rem;
	    line-height: 2rem;
	    background: #f07527;
	    color: #fff;
	    font-size: 1.8rem;
	    text-align: center;
	    border-radius: 3rem;
	    margin: 0 auto;
	    margin-top: 2rem;
	}
</style>

<header class="mui-bar mui-bar-nav">
	<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	<h1 class="mui-title">发布岗位</h1>
</header>

<div class="mui-content">
	<div class="release boxcontain container" id="RelA" data-rid="1">
		<h2>发布兼职 (1)</h2>
		<div class="statbox">
			<img src="/public/img/relA.png" class="auto-center">
		</div>
		<div class="boxcontain mar10 resu">
			<div class="mui-input-row">
				<label>岗位类别</label>
				<input type="text" placeholder="请选择岗位类别" id="jobtype" value="">
			</div>
		</div>
		<div class="row">
			<div class="col-xs-6 right">
				<button class="turn" data-turn="2">下一步</button>
			</div>
		</div>
	</div>
	<div class="release boxcontain container none" id="RelB" data-rid="2">
		<h2>发布兼职 (2)</h2>
		<div class="statbox">
			<img src="/public/img/relB.png" class="auto-center">
		</div>
		<div class="boxcontain mar10">
			<input type="text" placeholder="请输入职位名称" id="jobname" value="">
			<pre class="texts hidepre" id="pre"></pre>
			<textarea class="texts" id="textarea" placeholder="请输入职位描述"></textarea>
		</div>
		<div class="row">
			<div class="col-xs-6">
				<button class="turn" data-turn="1">上一步</button>
			</div>
			<div class="col-xs-6">
				<button class="turn" data-turn="3">下一步</button>
			</div>
		</div>
	</div>
	<div class="release boxcontain container none" id="RelC" data-rid="3">
		<h2>发布兼职 (3)</h2>
		<div class="statbox">
			<img src="/public/img/relC.png" class="auto-center">
		</div>
		<div class="boxcontain mar10 resu">
			<div class="mui-input-row">
				<label>计薪方式</label>
				<input type="text" placeholder="请选择计薪方式" id="paytype" value="">
			</div>
			<div class="mui-input-row">
				<label>薪资</label>
				<input type="text" placeholder="请输入金额(元)" id="paymoney" value="">
			</div>
			<div class="mui-input-row">
				<label>结算时间</label>
				<input type="text" placeholder="请选择结算时间" id="paytime" value="">
			</div>
		</div>
		<div class="row">
			<div class="col-xs-6">
				<button class="turn" data-turn="2">上一步</button>
			</div>
			<div class="col-xs-6">
				<button class="turn" data-turn="4">下一步</button>
			</div>
		</div>
	</div>
	<div class="release boxcontain container none" id="RelD" data-rid="4">
		<h2>发布兼职 (4)</h2>
		<div class="statbox">
			<img src="/public/img/relD.png" class="auto-center">
		</div>
		<div class="boxcontain mar10 resu">
			<div class="mui-input-row">
				<label>开始日期</label>
				<input type="text" placeholder="请选择开始日期" id="jobstarday" value="" data-options='{"type":"date","beginYear":2018,"endYear":2022}'>
			</div>
			<div class="mui-input-row">
				<label>结束日期</label>
				<input type="text" placeholder="请选择结束日期" id="jobendday" value="" data-options='{"type":"date","beginYear":2018,"endYear":2022}'>
			</div>
			<div class="mui-input-row">
				<label>开始时间</label>
				<input type="text" placeholder="请选择开始时间" id="jobstartime" value="" data-options='{"type":"time"}'>
			</div>
			<div class="mui-input-row">
				<label>结束时间</label>
				<input type="text" placeholder="请选择结束时间" id="jobendtime" value="" data-options='{"type":"time"}'>
			</div>
			<div class="mui-input-row">
				<label>工作区域</label>
				<input type="text" placeholder="请选择工作区域" id="jobarea" value="">
				<input type="hidden" id="jobcity">
			</div>
			<div class="mui-input-row">
				<label>详细地址</label>
				<!-- <span class="btn btn-default fileinput-button">
		            <span>上传图片...</span>
		            <input type="button" id="addaddress">
		        </span> -->
				<input type="text" placeholder="添加工作地点" id="inputAddress" v-model="inputtext">
				<input type="hidden" id="lng">
				<input type="hidden" id="lat">
			</div>
			<!-- <div id="r-result"></div> -->
		</div>
		<div class="row">
			<div class="col-xs-6">
				<button class="turn" data-turn="3">上一步</button>
			</div>
			<div class="col-xs-6">
				<button class="turn" data-turn="5">下一步</button>
			</div>
		</div>
	</div>
	<div class="release boxcontain container none" id="RelE" data-rid="5">
		<h2>发布兼职 (5)</h2>
		<div class="statbox">
			<img src="/public/img/relE.png" class="auto-center">
		</div>
		<div class="boxcontain mar10 resu">
			<div class="mui-input-row">
				<label>企业全称</label>
				<input type="text" placeholder="请输入企业全称" id="companyname" value="">
			</div>
			<div class="mui-input-row">
				<label>联系人</label>
				<input type="text" placeholder="请输入联系人姓名" id="companyman" value="">
			</div>
			<div class="mui-input-row">
				<label>联系电话</label>
				<input type="text" placeholder="请输入联系电话" id="companytel" value="">
			</div>
			<div class="mar10">
				<label>微信二维码</label>
				<span class="btn btn-default fileinput-button">
		            <span>上传图片...</span>
		            <input type="file" accept="image/jpg ,image/jpeg ,image/png" onchange="imgChange(event)" id="file">
		        </span>
		        <div class="imgbox rel">
					<img src="" class="auto-center" id="showImage">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-xs-6">
				<button class="turn" data-turn="4">上一步</button>
			</div>
			<div class="col-xs-6">
				<button class="push">发布</button>
			</div>
		</div>
	</div>
</div>

<!-- <div id="Address" class="boxcontain container">
	<input type="text" placeholder="请输入地址" id="addressText" value="">
	
</div> -->

<div id="allmap"></div>
<script type="text/javascript">


	//index 4
	var lng;	//经度
	var lat;	//纬度
	var district;
	var name;

	var textarea = document.getElementById('textarea');
	var pre = document.getElementById('pre');

	textarea.oninput = function() {
	    pre.textContent = textarea.value;
	    textarea.style.height = pre.offsetHeight + 'px';
	}

	var base;

	function imgChange(e) {
	    var reader = new FileReader();
	    reader.onload = (function (file) {
	        return function (e) {
	        	if(e.total>10*1024*1024){
			        //alert('上传的图片的大于4M,请重新选择');
			        layer.msg('上传的图片的大于10M,请重新选择。',{icon: 5});
			        return false;
		        } else {
		        	$('.imgbox').css({"width":"8rem","height":"8rem"});
		        	var IMG = new Image();
		        	IMG.src = this.result;
		            IMG.onload = function(){
	      				var w = this.naturalWidth, h = this.naturalHeight , resizeW = 0, resizeH = 0;
	      				console.log(w,h)
	      			
		      			var maxSize = {
					        width: 1200,
					        height: 1000,
					        level: 0.6
					    };
					    if(w > maxSize.width || h > maxSize.height){
					        var multiple = Math.max(w / maxSize.width, h / maxSize.height);
					        resizeW = w / multiple;
					        resizeH = h / multiple;
					        var canvas = document.createElement('canvas'),
						    ctx = canvas.getContext('2d');
					        canvas.width = resizeW;
					        canvas.height = resizeH;
					        ctx.drawImage(IMG, 0, 0, resizeW, resizeH);
						    var base64 = canvas.toDataURL('image/jpeg', maxSize.level);
						    $("#showImage")[0].src=base64;
						    var arr = base64.split(',');
				            base = arr[1];
				            console.log(base64)
					    } else {
					        // 如果图片尺寸小于最大限制，则不压缩直接上传
					        $("#showImage")[0].src=IMG.src;
				            var arr = IMG.src.split(',');
				            base = arr[1];
				            console.log(base);
					    }
					    
				    }
	        	
	            //console.log(this.result); //这个就是base64的数据了
		            // $("#showImage")[0].src=this.result;
		            // var arr = this.result.split(',');
		            // base = arr[1];
		            // console.log(base);
	            }
	        };
	    })(e.target.files[0]);
	    reader.readAsDataURL(e.target.files[0]);
	}

	$(".turn").on('tap',function(){
		var page = $(this).attr('data-turn');
		$('.release').hide();
		$(".release[data-rid='"+page+"']").fadeIn(200);
	});

	$('.push').on('tap',function(){
		layer.msg("发布成功！",{time:2000});
		setTimeout("window.location.href = '/manager/index'",2000);
	});

	$("#inputAddress").on('tap',function(){
		var cityA = $("#jobcity").val();
		AMap.plugin('AMap.Autocomplete',function(){//回调函数
		    var autoOptions = {
		        city: cityA, //城市，默认全国
		        citylimit: true,
		        input:"inputAddress"//使用联想输入的input的id
		    };
		    var autocomplete= new AMap.Autocomplete(autoOptions);

		    AMap.event.addListener(autocomplete, "select", function(data){
		        console.log(data)
		        district = data.poi.district;
		        name = data.poi.name;
		        lng = data.poi.location.lng;
		        lat = data.poi.location.lat;
		        console.log(district,name,lng,lat)
		        $("#jobarea").val(district);
		    }); 
		});
	})
	

</script>
{% endblock %}
{% block footer %}
       
{% endblock %}